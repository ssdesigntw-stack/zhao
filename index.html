<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>æ˜­å®‰å®®è¾²æ°‘æ›†</title>

  <!-- âœ… iOS å…¨è¢å¹• App æ¨¡å¼è¨­å®š -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="æ˜­å®‰å®®è¾²æ°‘æ›†">

  <!-- âœ… ä¸»ç•«é¢åœ–ç¤º -->
  <link rel="apple-touch-icon" href="logo.jpg">
  <link rel="manifest" href="manifest.json">
  
  <style>
    body {
      margin: 0;
      font-family: "Noto Sans TC", sans-serif;
      background: #fff5f5;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #pdf-viewer {
      width: 100%;
      max-width: 900px;
      text-align: center;
    }

    canvas {
      width: 98%;
      border-radius: 10px;
      border: 2px solid #d4af37;
      box-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
      touch-action: pan-y;
      -webkit-user-select: none;
      user-select: none;
      opacity: 1;
      transition: opacity 0.3s ease;
    }

    /* âœ¨ æ§åˆ¶å€èˆ‡æœˆåˆ†åˆ— */
    .controls, .month-bar {
      margin: 10px 0;
    }

    /* ğŸ¨ ç²¾ç·»æŒ‰éˆ•è¨­è¨ˆ */
    button {
      position: relative;
      padding: 10px 16px;
      font-size: 15px;
      margin: 4px 6px;
      cursor: pointer;
      border: none;
      border-radius: 10px;
      background: linear-gradient(145deg, #d32f2f, #b71c1c);
      color: #fffbe6;
      font-weight: 600;
      box-shadow:
        0 2px 4px rgba(0, 0, 0, 0.15),
        inset 0 1px 2px rgba(255, 255, 255, 0.2);
      transition: all 0.2s ease-in-out;
    }

    button:hover {
      background: linear-gradient(145deg, #e53935, #c62828);
      box-shadow:
        0 3px 8px rgba(0, 0, 0, 0.2),
        0 0 8px rgba(255, 215, 0, 0.4);
      transform: translateY(-2px);
    }

    button:active {
      transform: translateY(1px);
      box-shadow:
        inset 0 2px 4px rgba(0, 0, 0, 0.3),
        0 0 3px rgba(255, 215, 0, 0.4);
    }

    /* ğŸ“œ æœˆä»½åˆ—å¤–è§€ */
    .month-bar {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      background: #fff0f0;
      padding: 10px;
      border-radius: 12px;
      border: 1.5px solid #e0b600;
      box-shadow:
        inset 0 1px 3px rgba(255, 255, 255, 0.5),
        0 2px 8px rgba(212, 175, 55, 0.15);
      overflow-x: auto;
      white-space: nowrap;
      scroll-behavior: smooth;
    }

    /* ğŸŒŸ é¸ä¸­æœˆåˆ†çš„ç¥ç¤¾é‡‘å…‰æ•ˆæœ */
    button.active {
      background: linear-gradient(160deg, #ffeb3b, #fdd835);
      color: #8b0000;
      font-weight: 700;
      box-shadow:
        0 0 12px rgba(255, 230, 100, 0.7),
        inset 0 0 4px rgba(255, 255, 255, 0.7);
      text-shadow: 0 0 4px rgba(255, 255, 255, 0.9);
    }

    /* âœ¨ æœˆä»½åˆ— scrollbar å¾®é‡‘åŒ– */
    .month-bar::-webkit-scrollbar {
      height: 6px;
    }
    .month-bar::-webkit-scrollbar-thumb {
      background-color: #d4af37;
      border-radius: 3px;
    }
    .month-bar::-webkit-scrollbar-track {
      background-color: #fff5f5;
    }

    /* é ç¢¼æ–‡å­— */
    #page-info {
      color: #b71c1c;
      font-weight: 600;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <div id="pdf-viewer">
    <div class="month-bar" id="month-bar"></div>

    <canvas id="pdf-canvas"></canvas>

    <div class="controls">
      <button id="prev">ä¸Šä¸€é </button>
      <span id="page-info"></span>
      <button id="next">ä¸‹ä¸€é </button>
    </div>
  </div>

  <!-- PDF.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    const url = 'zhao.pdf';
    let pdfDoc = null, pageNum = 1;
    const canvas = document.getElementById('pdf-canvas');
    const ctx = canvas.getContext('2d');

    pdfjsLib.GlobalWorkerOptions.workerSrc =
      'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

    const contentPages = {
      1: 1, 2: 12, 3: 13, 4: 14, 5: 18, 6: 20,
      7: 28, 8: 34, 9: 38, 10: 44, 11: 48, 12: 54
    };

    const btnNames = {
      1: 'æ˜­å®‰å®®ç°¡ä»‹', 2: 'é»å…‰æ˜ç‡ˆ', 3: 'æ…¶å…¸æ—¥æœŸ', 4: 'äº¤æ¥å…¸ç¦®',
      5: 'å¤ªæ­²ä¸™åˆå¹´', 6: '2026/1-3æœˆ', 7: '2026/4-6æœˆ',
      8: '2026/7-9æœˆ', 9: '2026/10-12æœˆ', 10: '2027/1-2æœˆ',
      11: 'ç”Ÿè‚–é‹å‹¢', 12: 'æ™‚è¾°å‰æ—¥'
    };

    // ğŸŸ¡ ç”¢ç”Ÿæœˆä»½æŒ‰éˆ•
    const monthBar = document.getElementById('month-bar');
    for (let i = 1; i <= 12; i++) {
      const btn = document.createElement('button');
      btn.textContent = btnNames[i];
      btn.dataset.month = i;
      btn.addEventListener('click', () => {
        if (pdfDoc) {
          pageNum = contentPages[i];
          smoothRender(pageNum);
          highlightMonth(i);
        }
      });
      monthBar.appendChild(btn);
    }

    function highlightMonth(activeMonth) {
      document.querySelectorAll('.month-bar button').forEach(btn => {
        btn.classList.toggle('active', parseInt(btn.dataset.month) === activeMonth);
      });
    }

    // ğŸ“– è¼‰å…¥ PDF
    pdfjsLib.getDocument(url).promise.then(pdfDoc_ => {
      pdfDoc = pdfDoc_;
      smoothRender(pageNum);
      highlightMonth(1);
    });

    // âœ… å¹³æ»‘æ¸²æŸ“ï¼ˆé è¼‰ä¸‹ä¸€é é˜²é–ƒçˆï¼‰
    async function smoothRender(num) {
      const tempCanvas = document.createElement('canvas');
      const tempCtx = tempCanvas.getContext('2d');
      const page = await pdfDoc.getPage(num);
      const viewport = page.getViewport({ scale: 1.5 });

      tempCanvas.width = viewport.width;
      tempCanvas.height = viewport.height;
      await page.render({ canvasContext: tempCtx, viewport }).promise;

      // æ·¡å‡ºèˆŠé 
      canvas.style.transition = 'opacity 0.3s ease';
      canvas.style.opacity = 0;

      setTimeout(() => {
        // æ›¿æ›ç•«é¢
        canvas.width = tempCanvas.width;
        canvas.height = tempCanvas.height;
        ctx.drawImage(tempCanvas, 0, 0);
        document.getElementById('page-info').textContent =
          `ç¬¬ ${num} / ${pdfDoc.numPages} é `;
        canvas.style.opacity = 1;
      }, 150);
    }

    // â®ï¸ â­ï¸ æŒ‰éˆ•æ›é 
    document.getElementById('prev').addEventListener('click', () => {
      if (pageNum <= 1) return;
      pageNum--;
      smoothRender(pageNum);
    });

    document.getElementById('next').addEventListener('click', () => {
      if (pageNum >= pdfDoc.numPages) return;
      pageNum++;
      smoothRender(pageNum);
    });

    // ğŸ“± æ‰‹æ©Ÿæ»‘å‹•æ‰‹å‹¢ï¼ˆå·¦æ»‘ä¸Šä¸€é ã€å³æ»‘ä¸‹ä¸€é ï¼‰
    let touchStartX = 0;
    let touchEndX = 0;
    const threshold = 50;

    function onTouchStart(e) {
      const x = e.changedTouches ? e.changedTouches[0].clientX : e.clientX;
      touchStartX = x;
      touchEndX = x;
    }

    function onTouchMove(e) {
      const x = e.changedTouches ? e.changedTouches[0].clientX : e.clientX;
      touchEndX = x;
      e.preventDefault();
    }

    function onTouchEnd() {
      const diffX = touchEndX - touchStartX;
      if (Math.abs(diffX) < threshold) return;

      if (diffX > 0) {
        // ğŸ‘‰ å³æ»‘ â†’ ä¸‹ä¸€é 
        if (pageNum < pdfDoc.numPages) {
          pageNum++;
          smoothRender(pageNum);
        }
      } else {
        // ğŸ‘ˆ å·¦æ»‘ â†’ ä¸Šä¸€é 
        if (pageNum > 1) {
          pageNum--;
          smoothRender(pageNum);
        }
      }
    }

    canvas.addEventListener('touchstart', onTouchStart, { passive: true });
    canvas.addEventListener('touchmove', onTouchMove, { passive: false });
    canvas.addEventListener('touchend', onTouchEnd, { passive: true });
  </script>
</body>
</html>
